<div>
    <div class="row">
        <div class="col-lg-6 col-md-6 col-xs-6 col-sm-6">
            <div class="form-group">

                <div ng-if="model.source.domainType === 'DataModel'">
                    <span class="badge importFormStep themeBackgroundColor">1</span>
                    <span ><label>Source Data Model</label><span style="margin-left:3px;font-size: 12px;cursor: pointer;" ng-if="model.sourceLink"><a href="{{model.sourceLink}}" target="_blank"><i class="fa fa-external-link themeColor"></i></a></span></span>
                    <model-selector-tree
                            processing="model.loadingSource"
                            placeholder="'Select Source Data Model...'"
                            on-select="onSourceSelect"
                            default-elements="[model.source]"
                            do-not-show-data-classes="true"
                            ng-model="model.source"
                            tree-search-domain-type="'DataModel'"
                            accepts="['DataModel']">
                    </model-selector-tree>
                </div>
                <div ng-if="model.source.domainType === 'DataElement'">
                    <span class="badge importFormStep themeBackgroundColor">1</span>
                    <span><label>Source Data Element</label></span>
                    <div style="padding-left: 5px;">
                        <element-link
                                new-window="true"
                                show-type-title = "true"
                                mc-element="model.source"></element-link>
                        <br>
                        <model-path  path="model.source.breadcrumbs" new-window="true"></model-path>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <span class="badge importFormStep themeBackgroundColor">2</span>
                <label>Target Data Model</label><span style="margin-left:3px;font-size: 12px;cursor: pointer;" ng-if="model.targetLink"><a href="{{model.targetLink}}" target="_blank"><i class="fa fa-external-link themeColor"></i></a></span>
                <model-selector-tree
                        processing="model.processing"
                        placeholder="'Select Target Data Model...'"
                        on-select="onTargetSelect"
                        default-elements="[model.target]"
                        do-not-show-data-classes="true"
                        ng-model="model.target"
                        tree-search-domain-type="'DataModel'"
                        accepts="['DataModel']">
                </model-selector-tree>
            </div>

            <div class="form-group">
                <div style="margin-bottom: 20px">
                    <input type="checkbox"
                           style="cursor: pointer"
                           ng-model="doNotSuggest">
                    <span style="vertical-align: top;">&nbsp;Do not suggest for Data Elements which already have Links. </span>
                </div>
            </div>

            <div style="margin-bottom: 5px;">
                <button type="button" class="btn btn-success btn-sm" ng-click="suggest()"
                        ng-disabled="model.processing || !model.source || !model.target || (model.source && model.target && model.source.id === model.target.id)">
                    Suggest
                </button>
            </div>
            <div style="width:100%;min-height: 30px;">
                <div class="alert alert-warning" ng-if="!model.sourceEditable">
                   <span ng-if="model.source.domainType==='DataModel'"><strong>Source Data Model</strong> is not editable! <br>You can get link suggestions but can't add Links.</span>
                   <span ng-if="model.source.domainType==='DataElement'"><strong>Source Data Element</strong> is not editable! <br>You can get link suggestions but can't add Links.</span>
                </div>

                <div class="alert alert-danger" ng-if="model.source && model.target && model.source.id === model.target.id">
                    Source and Target Data Model can not be the same!
                </div>

                <uib-progressbar max="100" value="100" class="progress-striped active"
                                 style="margin-bottom: 0px !important;" ng-show="model.processing">
                    <span style="color:white; white-space:nowrap;"></span>
                </uib-progressbar>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-10 col-md-10 col-xs-10 col-sm-10">
            <div>
                <mc-table
                        mc-name="metadataTable"
                        id="metadataTable"
                        mc-record-type="'static'"

                        mc-records="model.suggestions"
                        mc-static-loading-in-progress="loading"
                        mc-table-handler="mcTableHandler"
                        mc-display-records="mcDisplayRecords"
                        mc-page-sizes="[5,10,15,20]"
                        mc-page-size="5"
                        mc-page-number="1">
                    <div class="mcTableMain">
                        <div class="mcTableTitle">
                            <span class="title">Suggested Links</span>

                            <div class="btn-group-xs" style="float: right; margin-top: -2px; margin-left: 9px;font-weight: normal !important;" ng-if="model.successfullyAdded > 0">
                                Successfully Added <span style="font-weight: normal !important;" class="badge badge-success">{{model.successfullyAdded}}</span>
                            </div>

                            <div class="btn-group-xs" style="float: right; margin-top: -2px; margin-left: 9px;font-weight: normal !important;" ng-if="model. totalIgnoredLinks > 0">
                                Ignored <span style="font-weight: normal !important;" class="badge badge-success">{{model.totalIgnoredLinks}}</span>
                            </div>

                            <div class="btn-group-xs" style="float: right; margin-top: -2px; margin-left: 9px;font-weight: normal !important;" ng-if="model. totalSuggestionLinks > 0 && model.source.domainType === 'DataModel'">
                                Total Suggested Links <span style="font-weight: normal !important;" class="badge badge-success">{{model. totalSuggestionLinks}}</span>
                            </div>

                        </div>
                        <div class="mcTableContainer">
                            <table class="table table-condensed table-bordered mcTable">
                                <thead>
                                <tr class="mcTableHeader">
                                    <th style="cursor:pointer;max-width: 20%;width: 20%;" columnName="sourceDataElement.label" sortable="true" filterable="true">
                                        Source Data Element
                                    </th>
                                    <th style="cursor:pointer;max-width: 20%;width: 20%;"  columnName="key" sortable="false" filterable="false">
                                        Target Data Element
                                    </th>
                                    <th style="cursor:pointer;max-width: 8%;width: 8%;" columnName="success"  sortable="true" >
                                    </th>
                                </tr>
                                <tr class="mcTableFilter">
                                    <td style="max-width: 20%;width: 20%;">
                                        <input class="form-control input-sm" type="text" autocomplete="off">
                                    </td>
                                    <td style="max-width: 20%;width: 20%;">
                                        <input class="form-control input-sm" type="text" autocomplete="off">
                                    </td>
                                    <td style="max-width: 8%;width: 8%;">
                                    </td>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="suggest in mcDisplayRecords" ng-class="{'linkSuggestion':true, 'fadeOut':suggest.success || suggest.ignore}">
                                <!--<tr ng-repeat="suggest in mcDisplayRecords">-->
                                    <td style="max-width: 20%;width: 20%;text-align: left;word-wrap: break-word;">
                                        <div style="margin-bottom: 10px;">
                                            <element-link
                                                    new-window="true"
                                                    show-type-title = "false"
                                                    mc-element="suggest.sourceDataElement"></element-link>
                                        </div>
                                        <model-path path="suggest.sourceDataElement.breadcrumbs"
                                                    new-window="true"
                                                    do-not-display-status="true"
                                                    do-not-show-parent-data-model="true"></model-path>
                                    </td>
                                    <td style="max-width: 20%;width: 20%;text-align: left;word-wrap: break-word;">
                                        <div ng-if="!suggest.showMore">
                                            <div style="float:left;">
                                                <div style="margin-bottom: 10px;">
                                                    <element-link
                                                            new-window="true"
                                                            show-type-title="false"
                                                            mc-element="suggest.selectedTarget.dataElement"></element-link>
                                                </div>
                                                <model-path path="suggest.selectedTarget.dataElement.breadcrumbs"
                                                            new-window="true"
                                                            do-not-display-status="true"
                                                            do-not-show-parent-data-model="true"></model-path>
                                            </div>
                                            <div style="float:right;top:0;right:0;position: relative;" ng-if="suggest.results && suggest.results.length > 0">
                                                <a style="font-size: 12px; font-style:italic; cursor: pointer;margin:5px;" ng-click="toggleShowMore(suggest)">more suggestions <i class="fa fa-caret-down" aria-hidden="true"></i></a>
                                            </div>
                                            <div ng-if="suggest.results && suggest.results.length === 0" style="font-style: italic;">
                                                No Suggestions!
                                            </div>

                                        </div>


                                        <div ng-if="suggest.showMore">
                                            <div style="float:left;width: 90%;">
                                                <mc-select-2
                                                        record="suggest"
                                                        width="'100%'"
                                                        default-value="suggest.selectedTarget"
                                                        multi-select="false"
                                                        accept-typed-input="false"
                                                        value-type="'static'"
                                                        static-values="suggest.results"
                                                        id-property="'dataElement.id'"
                                                        display-property="'dataElement.label'"
                                                        search-property="'dataElement.label'"
                                                        on-select="onTargetDateElementSelect">
                                                    <div>
                                                        <div>
                                                            <div>
                                                                {{$item.dataElement.label}}
                                                            </div>
                                                            <div>
                                                                <model-path path="$item.dataElement.breadcrumbs"
                                                                            new-window="true"
                                                                            do-not-display-status="true"
                                                                            do-not-show-parent-data-model="true"></model-path>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </mc-select-2>
                                            </div>
                                            <div style="float:left;margin-left:5px;margin-top:10px;">
                                                <a style="font-size: 12px; font-style:italic;cursor: pointer;" ng-click="toggleShowMore(suggest)">close</a>
                                            </div>
                                        </div>



                                    </td>
                                    <td style="max-width: 8%;width: 8%;text-align: center;word-wrap: break-word;">
                                        <div ng-if="!suggest.success && !suggest.processing">
                                            <button type="button" class="btn btn-success btn-sm" style="margin-bottom: 2px; min-width: 55px !important;" ng-click="approveSuggestion($index, suggest)" ng-disabled="!suggest.selectedTarget || !model.sourceEditable">
                                                Add
                                            </button>
                                            <button type="button" class="btn btn-default btn-sm" style="margin-bottom: 2px; min-width: 55px !important;" ng-click="ignoreSuggestion($index, suggest)" ng-disabled="!model.sourceEditable">
                                                Ignore
                                            </button>
                                        </div>
                                        <div ng-if="suggest.success">
                                            <div><i class="fa fa-check copyElementSuccess"></i>&nbsp;</div>
                                        </div>
                                        <div style="width:100%;height:100%;text-align: center" ng-if="suggest.processing">
                                            <div style="padding-top: 10%;">
                                                <i style="font-size: 20px;" class="fa fa-refresh fa-spin themeColor"></i>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="paginationContainer">
                            <mc-table-pagination display-records="mcDisplayRecords"></mc-table-pagination>
                        </div>
                    </div>
                </mc-table>
            </div>




            <!--<table class="table table-bordered" style="margin-top: 5px;">-->
                <!--<thead>-->
                    <!--<tr class="mcTableTitle">-->
                        <!--<th style="width:20%;min-width:50px;">Source Data Element</th>-->
                        <!--<th style="width:20%;min-width:50px">Suggested Target Data Element</th>-->
                        <!--<th style="width:8%;min-width:8%;"></th>-->
                    <!--</tr>-->
                <!--</thead>-->
                <!--<tbody>-->
                    <!--<tr ng-repeat="suggest in model.suggestions" >-->
                        <!--<td style="width:20%;min-width:50px;">-->
                            <!--<div style="margin-bottom: 10px;">-->
                                <!--<element-link-->
                                        <!--show-type-title = "false"-->
                                        <!--mc-element="suggest.sourceDataElement"></element-link>-->
                            <!--</div>-->
                            <!--<model-path path="suggest.sourceDataElement.breadcrumbs"-->
                                        <!--new-window="true"-->
                                        <!--do-not-display-status="true"-->
                                        <!--do-not-show-parent-data-model="true"></model-path>-->
                        <!--</td>-->
                        <!--<td style="width:20%;min-width:10%;">-->

                            <!--<div ng-if="!suggest.showMore">-->
                                <!--<div style="float:left;max-width: 80%;">-->
                                    <!--<div style="margin-bottom: 10px;">-->
                                        <!--<element-link-->
                                                <!--show-type-title = "false"-->
                                                <!--mc-element="suggest.selectedTarget"></element-link>-->
                                    <!--</div>-->
                                    <!--<model-path path="suggest.selectedTarget.breadcrumbs"-->
                                                <!--new-window="true"-->
                                                <!--do-not-display-status="true"-->
                                                <!--do-not-show-parent-data-model="true"></model-path>-->
                                <!--</div>-->
                                <!--<div style="float:right;">-->
                                    <!--<button type="button" class="btn btn-default btn-sm" style="margin-bottom: 2px; min-width: 55px !important;" ng-click="toggleShowMore(suggest)" ng-if="suggest.results.length > 1">-->
                                        <!--more ...-->
                                    <!--</button>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div ng-if="suggest.showMore">-->
                                <!--<mc-select-2-->
                                        <!--record="suggest"-->
                                        <!--width="'100%'"-->
                                        <!--default-value="suggest.selectedTarget"-->
                                        <!--multi-select="false"-->
                                        <!--accept-typed-input="false"-->
                                        <!--value-type="'static'"-->
                                        <!--static-values="suggest.results"-->
                                        <!--id-property="'dataElement.id'"-->
                                        <!--display-property="'dataElement.label'"-->
                                        <!--search-property="'dataElement.label'"-->
                                        <!--on-select="onTargetDateElementSelect">-->
                                    <!--<div>-->
                                        <!--<div>-->
                                            <!--<element-link-->
                                                    <!--show-type-title = "false"-->
                                                    <!--mc-element="$item.dataElement"></element-link>-->
                                            <!--<model-path path="$item.dataElement.breadcrumbs"-->
                                                        <!--new-window="true"-->
                                                        <!--do-not-display-status="true"-->
                                                        <!--do-not-show-parent-data-model="true"></model-path>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                <!--</mc-select-2>-->
                            <!--</div>-->

                        <!--</td>-->
                        <!--<td style="width:8%;min-width:8%;">-->
                            <!--<button type="button" class="btn btn-success btn-sm" style="margin-bottom: 2px; min-width: 55px !important;" ng-click="approveSuggestion(suggest)" ng-disabled="!suggest.selectedTarget || !model.sourceEditable">-->
                                <!--Add-->
                            <!--</button>-->
                            <!--<button type="button" class="btn btn-default btn-sm" style="margin-bottom: 2px; min-width: 55px !important;" ng-click="ignoreSuggestion($index, suggest)" ng-disabled="!model.sourceEditable">-->
                                <!--Ignore-->
                            <!--</button>-->
                        <!--</td>-->
                    <!--</tr>-->
                <!--</tbody>-->
            <!--</table>-->
            <!---->
        </div>
    </div>
</div>

