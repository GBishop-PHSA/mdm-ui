
<style media="screen" type="text/css">

    .ui-state-active,
    .ui-widget-content .ui-state-active,
    .ui-widget-header .ui-state-active,
    a.ui-button:active,
    .ui-button:active,
    .ui-button.ui-state-active:hover {
        border: 1px solid #205081 !important;
        background: #205081 !important;
    }


    .ui-dialog-titlebar-close{
        display: none;
    }

    .dataFlowSelectedElement {
        border: 1px solid #ff9933 !important;
        background-color: #fff2e6 !important;
    }

    .transformationToolBox {
        border: 1px dashed #5f6060;
        color: #205081;
        -moz-border-radius: 2px;
        -webkit-border-radius: 2px;
        border-radius: 2px;
        -khtml-border-radius: 2px;
        margin: 5px;
        cursor: move;
        width: 140px;
        text-align: center;
    }

    .transformationName {
        font-size: 14px;
        font-weight: bold;
        color: #205081;
        margin: 5px;
        text-align: center;
    }

    .dataFlow.deleteButton {
        font-size: 18px;
        position: absolute;
        top: -13px;
        left: -10px;
        color: red;
        background-color: transparent;
        cursor: pointer;
    }

    span.deleteIconContainer{
        background-color: transparent;
        line-height: 40%;
    }

    span.deleteIconContainer > i {
        padding: 0px;
        margin: 0px;
        display: inline-block;
        width: auto;
        height: auto;
        line-height: inherit;
        vertical-align: baseline;
        background-color: white;
    }


    .deleteButtonHide{
        display: none;
    }


    dataModel{
        border:  1px solid #DDD;
        width:150px;
        background-color: #FFF;
        min-height: 80px;
        text-align: center;
        cursor: move;
    }

    .dataModelTitle{
        padding: 10px;
        text-align: center;
        cursor: pointer;
    }


    .dataClass{
        border: 1px solid #d8d8d8;
        background-color: #f9f9f9;
        width:200px;
        min-height:100px;
    }





    .dataClassTitle{
        border-bottom: 2px solid #DDD;
        background-color: #e5e5e5;
        font-weight: bold;
        height:30px;
        text-align:center;
        padding: 5px;
        cursor: move;
        word-wrap: break-word;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .dataElement{
        padding-left: 3px;
        border-bottom:  1px solid #d8d8d8;
        cursor: pointer;
    }

    .dataElementContainer {
        width:100%;
        position: absolute;
        top: 40px;
        bottom: 0px;
        overflow-y: scroll;
        overflow-x: hidden;
    }


    .transformation{
        border: 2px solid #205081;
        background-color: #e0edf9;
        padding: 10px;
        cursor: move;
    }

    .transformationTitle {
        cursor: pointer;
    }

    div.designerContainer{
        border: 1px solid #DDD;
        width:  calc(99vw - 20px);
        height: calc(92vh - 5px);
        overflow: scroll;
    }

    div.designer{
        width: calc(200vw - 20px);
        height: calc(180vh - 10px);
        border: 1px solid #DDD;
        position:relative;
    }

    svg.designer {
        width: calc(200vw - 20px);
        height: calc(180vh - 10px);
        /*border: 1px solid black;*/
    }


    path.deletePath{
        cursor: pointer;
    }

    path.deletePathHide{
        display: none;
    }

    circle.middleCircle{
        cursor: pointer;
    }

    circle.middleCircleHide{
        display: none;
    }

    .fatPath {
        stroke: gray;
        stroke-width: 20;
        fill: none;
        opacity:0.1;
        cursor: pointer;
    }

    .fatPath.hideFatPath{
        stroke: transparent;
    }

</style>



<div style="width: 100%; margin: 5px auto;height: calc(100vh - 70px);border: 1px solid #DDD;">
    <div id="one-left" class="split split-horizontal" style="width: calc(20% - 5px);">

        <div id="one-left-top" class="split split-vertical" style="width: 100%;border: 1px solid #DDD;border-radius: 3px;">
            <div style="background-color: #f5f5f5; padding:5px 10px; border-bottom: 1px solid #ddd;">
                Source Model
            </div>
            <div style="width: 100%;height: 100%;" class="treeWaitingSpinner" ng-show="sourceTreeLoading">
                <div style="position: relative;top:calc(20vh - 10px);left:40%;">
                    <a style="font-size: 75px;" class="themeColor">
                        <i class="fa fa-refresh fa-spin treeViewSpinner"></i>
                    </a>
                </div>
            </div>
            <div ng-show="sourceTree && sourceTree.length > 0" style="padding: 2px 2px;">
                <div my-tree-for-a-model
                     expand-all="true"
                     on-select="sourceTreeOnSelect"
                     style="height: 100%;"
                     tree-name="'source'"
                     children="sourceTree"></div>
            </div>
            <div ng-show="source.childDataClasses && source.childDataClasses.length == 0">
                <span>{{source.label}}</span> <br>
                <span class="hasNoDataClasses"> No DataClasses!</span>
            </div>

        </div>
        <div id="one-left-bottom" class="split split-vertical" style="width: 100%;border: 1px solid #DDD;border-radius: 3px;">

            <uib-tabset>
                <uib-tab>
                    <uib-tab-heading>
                        Properties
                    </uib-tab-heading>
                    <div>
                        <div ng-show="selectedElement && selectedElement.domainType  == 'DataFlow'">
                            <form style="margin: 10px;">
                                <div class="form-group">
                                    <label for="dataFlowName">Name</label>
                                    <input ng-disabled="isReadOnly" class="form-control form-control-sm" id="dataFlowName" aria-describedby="emailHelp" placeholder="DataFlow Name" ng-model="form.label">
                                </div>
                                <div class="form-group">
                                    <label for="dataFlowDescription">Description</label>
                                    <textarea ng-disabled="isReadOnly" class="form-control form-control-sm" id="dataFlowDescription" placeholder="DataFlow Description" ng-model="form.description" rows="8"></textarea>
                                </div>
                                <button ng-disabled="isReadOnly" type="button" class="btn btn-primary btn-sm" ng-click="saveForm()">Save</button>
                                <button ng-disabled="isReadOnly" type="button" class="btn btn-default btn-sm" ng-click="cancelForm()">Cancel</button>
                            </form>
                        </div>
                        <div ng-show="selectedElement && selectedElement.type == 'dataClass'">
                            <table class="table table-hover table-condensed" >
                                <tbody>
                                    <tr>
                                        <td width="5px" style="border-top: 0px !important;">
                                            <strong>Name</strong>
                                            <div>{{form.label}}</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="5px" style="border-top: 0px !important;">
                                            <strong>Description</strong>
                                            <div>{{form.description}}</div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div ng-show="selectedElement && selectedElement.type == 'transformation'">
                            <form style="margin: 10px;">
                                <div class="form-group">
                                    <label for="transformationName">Name</label>
                                    <input ng-disabled="isReadOnly" class="form-control form-control-sm" id="transformationName" aria-describedby="emailHelp" placeholder="Transformation Name" ng-model="form.label">
                                </div>
                                <div class="form-group">
                                    <label for="transformationDescription">Description</label>
                                    <textarea ng-disabled="isReadOnly" class="form-control form-control-sm" id="transformationDescription" placeholder="Transformation Description" ng-model="form.description" rows="8"></textarea>
                                </div>
                                <!--<div class="form-group">-->
                                    <!--<label for="dataFlowVisible">Visible</label>-->
                                    <!--<input type="checkbox" id="dataFlowVisible" ng-model="form.visible">-->
                                <!--</div>-->
                                <button ng-disabled="isReadOnly" type="button" class="btn btn-primary btn-sm" ng-click="saveForm()">Save</button>
                                <button ng-disabled="isReadOnly" type="button" class="btn btn-default btn-sm" ng-click="cancelForm()">Cancel</button>
                            </form>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab ng-if="selectedElement && selectedElement.domainType == 'DataFlow'">
                    <uib-tab-heading>
                        Transformations <span ng-show="dataFlowHandler && dataFlowHandler.transformations.length>0">({{dataFlowHandler.transformations.length}})</span>
                    </uib-tab-heading>
                    <div>
                        <table class="table table-hover table-condensed">
                            <thead>
                                <th width="10px"><i class="fa fa-eye" aria-hidden="true"></i></th>
                                <th>Name</th>
                                <th>Description</th>
                            </thead>
                            <tbody>
                                <tr ng-repeat="t in dataFlowHandler.transformations">
                                    <td width="10px">
                                        <input type="checkbox" ng-model="t.visible" ng-change="toggleTransformation(t)">
                                    </td>
                                    <td>
                                        <!--<input class="form-control input-sm" ng-model="t.transformation.label">-->
                                        {{t.transformation.label}}
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </uib-tab>
                <uib-tab ng-if="selectedElement && selectedElement.domainType == 'DataFlow'">
                    <uib-tab-heading>
                        Properties
                    </uib-tab-heading>
                    <div>
                        <mc-data-set-metadata
                                parent="selectedElement"
                                type = "'dynamic'"
                                loading-data="loadingData"></mc-data-set-metadata>
                    </div>
                </uib-tab>
                <uib-tab ng-if="selectedElement && selectedElement.domainType == 'DataFlow'">
                    <uib-tab-heading>
                        Comments
                    </uib-tab-heading>
                    <div>
                        <annotation-list parent="selectedElement"
                                         loading-data="loadingData"
                                         type="'dynamic'"></annotation-list>
                    </div>
                </uib-tab>
                <uib-tab
                        ng-if="selectedElement && selectedElement.transformation && selectedElement.transformation.id && selectedElement.type == 'transformation'">
                    <uib-tab-heading>
                        Properties
                    </uib-tab-heading>
                    <div>
                        <mc-data-set-metadata
                                parent="selectedElement.transformation"
                                type = "'dynamic'"
                                loading-data="loadingData"></mc-data-set-metadata>
                    </div>
                </uib-tab>
                <uib-tab
                        ng-if="selectedElement && selectedElement.transformation && selectedElement.transformation.id && selectedElement.type == 'transformation'">
                    <uib-tab-heading>
                        Comments
                    </uib-tab-heading>
                    <div>
                        <annotation-list parent="selectedElement.transformation"
                                         loading-data="loadingData"
                                         type="'dynamic'"></annotation-list>
                    </div>
                </uib-tab>

            </uib-tabset>

        </div>
    </div>
    <div id="one-centre" class="split split-horizontal" style="width: calc(60% - 5px);overflow-y: hidden">
        <div style="width: 100%; margin: 0 auto;height:30px;">
            <div style="float:left" ng-if="!isReadOnly" class="transformationToolBox"  uib-tooltip="Drag & Drop to add a new transformation" >New
                Transformation</div>
            <div style="float:right" class="transformationName" ng-show="dataFlow"> {{dataFlow.label}} </div>
        </div>
        <div style="width: 100%; margin: 0 auto;height: calc(80% - 10px);">
            <div>
                <div class="designerContainer">
                    <div class="designer">
                        <div id="dialog-confirm" title="DataFlow" style="display: none;">
                            Are you sure?
                        </div>
                        <svg class="designer" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <marker id="markerCircle" markerWidth="8" markerHeight="8" refX="5" refY="5">
                                    <circle cx="5" cy="5" r="3" style="stroke: none; fill:#000000;"/>
                                </marker>
                                <marker id="markerArrow" markerWidth="13" markerHeight="13" refX="2" refY="6" orient="auto">
                                    <path d="M2,2 L2,11 L10,6 L2,2" style="fill: #000000;"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="one-right" class="split split-horizontal" style="width: calc(20% - 5px);">
        <div style="background-color: #f5f5f5; padding:5px 10px; border-bottom: 1px solid #ddd;">
            Target Model
        </div>
        <div style="width: 100%;height: 100%;" class="treeWaitingSpinner" ng-show="targetTreeLoading">
            <div style="position: relative;top:calc(25vh - 50px);left:40%;">
                <a style="font-size: 75px;" class="themeColor">
                    <i class="fa fa-refresh fa-spin treeViewSpinner"></i>
                </a>
            </div>
        </div>
        <div ng-show="targetTree && targetTree.length > 0" style="padding: 2px 2px;">
            <div my-tree-for-a-model
                 expand-all="true"
                 on-select="targetTreeOnSelect"
                 style="height: 100%;"
                 tree-name="'target'"
                 children="targetTree"></div>
        </div>
        <div ng-show="targetTree.childDataClasses && targetTree.childDataClasses.length == 0">
            <span>{{source.label}}</span> <br>
            <span class="hasNoDataClasses"> No DataClasses!</span>
        </div>


    </div>
</div>


<script type="text/javascript">

    $(function() {
        Split(['#one-left-top', '#one-left-bottom'], {
            sizes: [65, 35],
            direction: 'vertical'
        });

        Split(['#one-left', '#one-centre', '#one-right'], {sizes: [20, 60, 20]});

        $(".transformationToolBox").draggable({
            helper: "clone"
        });

    });

</script>
