<div *ngIf="mcTerminology">
    <div class="panel panel-default">
        <form editable-form
              name="editableForm"
              onaftersave="onAfterSave()"
              (ngSubmit)="formBeforeSave()"
              onkeypress="return event.keyCode != 13;">
            <div class="panel-body panel-table">
                <h4>
                    <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10" style="padding: 0px !important;">
                        <span [ngClass]="{'deletedDataModelTitle':mcTerminology?.deleted, 'xeditableInput':true}">
                            <span [innerHTML]="mcTerminology.label" class="dataModelDetailsLabel"> 
                                <!-- TODO ADD SEARCH CRITERA PIPE -->
                            </span>
                            <i [ngClass]="{'fas fa-star favouritesIcon':true, addedToFavourite:addedToFavourite}"
                               (click)="toggleFavourite()"
                               matTooltip="Favourite"></i>
                            <i class="fas fa-info-circle helpIcon" (click)="loadHelp()" matTooltipPosition="left" matTooltip="Help"></i>
                        </span>
                        <span class="publiclyReadable" *ngIf="mcTerminology.readableByEveryone">
                            <i class="fas fa-globe-europe" aria-hidden="true" title="Publicly Readable"></i>
                        </span>
                    </div>
                    <div class="dataModelTypeIcon">
                        <i matTooltip="Terminology" style="font-size: 30px;" class="fas fa-book"></i>
                    </div>
                </h4>
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="padding: 0px !important;">
                    <small class="elementDetailMCType">Terminology</small>
                    <app-element-status [result]="mcTerminology"></app-element-status>
                    <span *ngIf="mcTerminology.deleted" class="label label-danger"
                          style="vertical-align: middle; font-size: 9px;">Deleted</span>
                    <br>
                    <div style="font-size: 12px; font-style: italic;">
                        Version: {{mcTerminology.documentationVersion}}
                    </div>
                    <span style="font-size: 11px; font-style: italic" class="dataModelDetailsLastUpdate">Last Update: {{mcTerminology.lastUpdated | date:"yyyy-MM-dd HH:mm:ss" }}</span>
                    <span *ngIf="mcTerminology.finalised && mcTerminology.dateFinalised"
                          style="font-size: 11px; font-style: italic; margin-left: 10px"
                          class="dataModelDetailsLastUpdate">Finalised On: {{mcTerminology.dateFinalised | date:"yyyy-MM-dd HH:mm:ss" }}</span>
                </div>
            </div>
            <table class="table dataModelDetailTable">
                <tbody>
                    <tr>
                        <td class="detailsRowHeader">Aliases</td>
                        <td>
                            <div style="width: 50%">
                                <app-element-alias [inEditMode]="false"
                                                   [aliases]="mcTerminology.editAliases"></app-element-alias>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="detailsRowHeader">Author</td>
                        <td>
                            {{mcTerminology.author}}
                        </td>
                    </tr>
                    <tr>
                        <td class="detailsRowHeader">Organisation</td>
                        <td>
                            {{mcTerminology.organisation}}
                        </td>
                    </tr>
                    <tr>
                        <td class="detailsRowHeader">Description</td>
                        <td class="elementDetailDescription">
                            <markdown-text-area [editable-form]="editableForm" [element]="mcTerminology" [property]="'description'"></markdown-text-area>
                        </td>
                    </tr>
                    <tr>
                        <td class="detailsRowHeader">Classifications</td>
                        <td>
                            <app-element-classifications [(classifications)]="mcTerminology.classifiers" [editable-form]="editableForm"></app-element-classifications>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: right;">

                            <div style="float: right; margin-bottom: 3px; margin-left: 5px;"
                                 [hidden]="editableForm.visible || editableForm.deletePending" *ngIf="showDelete">
                                <div style="float: right; margin-bottom: 3px; margin-left: 5px;"
                                     [hidden]="editableForm.visible || editableForm.deletePending" uib-dropdown
                                     is-open="false" *ngIf="showDelete">
                                    <button type="button"
                                            matTooltip="Delete"
                                            class="btn btn-default btn-xs dropdown-toggle"
                                            [disabled]="deleteInProgress || exporting"
                                            [matMenuTriggerFor]="menu">
                                        <i class="far fa-trash-alt warning"></i>
                                        <span class="caret" style="margin-right: 2px;"></span>
                                    </button>

                                    <mat-menu #menu="matMenu">
                                        <button mat-menu-item class="modelFilterItem" (click)="askForSoftDelete()"
                                                *ngIf="!mcTerminology?.deleted">
                                            <a title="Just mark it as deleted">Mark as deleted</a>
                                        </button>
                                        <button mat-menu-item class="modelFilterItem" (click)="askForPermanentDelete()">
                                            <a title="Permanently delete the Terminology">Delete <span class="errorMessage">permanently</span></a>
                                        </button>
                                    </mat-menu>
                                </div>
                            </div>

                            <div style="float: right; margin-bottom: 3px">
                                <div *ngIf="showEdit" [hidden]="editableForm.visible || editableForm.deletePending"
                                     class="btn-group-xs" uib-dropdown is-open="false"
                                     style="margin-bottom: 3px; position: relative; float: right; margin-right: 4px;">
                                    <button id="singleX-button" type="button"
                                            class="btn btn-xs dropdown-toggle btn-default addNewModelButton"
                                            [hidden]="editableForm.visible || editableForm.deletePending"
                                            [disabled]="deleteInProgress || exporting || mcTerminology.finalised"
                                            matTooltip="Edit"
                                            (click)="showForm();"
                                            uib-dropdown-toggle>
                                        <i class="fas fa-pencil-alt" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <editable-form-buttons [hidden]="!editableForm.visible"
                                                       [on-cancel-edit]="onCancelEdit"
                                                       [editable]="editableForm"
                                                       [text-location]="'left'"
                                                       [hide-delete]="true"
                                                       [hide-cancel]="false"
                                                       [processing]="deleteInProgress"></editable-form-buttons>
                            </div>

                            <div *ngIf="showFinalise && !editableForm.visible && !editableForm.deletePending" class="btn-group-xs" style="margin-bottom: 3px; position: relative; float: right; margin-right: 4px;">
                                <button class="btn btn-xs btn-default"
                                        (click)="finalise()" matTooltip="Finalise" type="button"
                                        [disabled]="deleteInProgress || processing">
                                    <i class="fas fa-check-circle" aria-hidden="true"></i>
                                </button>
                            </div>

                            <div *ngIf="showPermission" matTooltip="User & Group Access" class="btn-group-xs" style="margin-bottom: 3px; position: relative; float: right; margin-right: 4px;" [hidden]="editableForm.visible || editableForm.deletePending">
                                <button class="btn btn-xs btn-default addNewModelButton"
                                        (click)="toggleSecuritySection()"
                                        type="button"
                                        *ngIf="showPermission"
                                        [disabled]="deleteInProgress || processing"
                                        [hidden]="editableForm.visible || editableForm.deletePending">
                                    <i class="fas fa-user userAccess"></i>
                                </button>

                            </div>

                            <div *ngIf="showNewVersion && !editableForm.visible && !editableForm.deletePending" class="btn-group-xs" style="margin-bottom: 3px; position: relative; float: right; margin-right: 4px;">
                                <button class="btn btn-xs btn-default addNewModelButton" (click)="newVersion()" type="button" matTooltip="Create a New Version" [disabled]="deleteInProgress || processing">
                                    <i class="fas fa-copy userAccess"></i>
                                </button>
                            </div>
                            <!--  <div class="deleteInProgressSpinner"
                                       style="margin-bottom: 3px;position: relative; float: right; margin-right:8px;"
                                       ng-show="deleteInProgress">
                                <a style="font-size: 14px; text-decoration: none;">
                                    <i class="fas fa-sync-alt fa-spin"></i> Deleting...
                                </a>
                            </div>


                            <div style="margin-bottom: 3px;position: relative; float: right; margin-right:8px;"
                                 ng-show="exportedFileIsReady">
                                <div id="exportFileDownload"></div>
                            </div>
                            <div style="clear: both;" ng-show="processing">
                                <uib-progressbar max="100" value="100" class="progress-striped active">
                                    <span style="color:white; white-space:nowrap;"></span>
                                </uib-progressbar>
                            </div>
                            <div style="text-align: left" ng-show="exportError">
                                <div style="padding-top: 25px;">
                                    <div class="alert alert-danger">
                                        <a class="close" ng-click="resetExportError()" aria-label="close">&times;</a>
                                        <strong>Error!</strong> {{exportError}}
                                    </div>
                                </div>
                            </div>-->
                        </td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>
    <div class="userAccess" *ngIf="securitySection"
         style="margin: 10px 0px 50px 0px">
        <app-share-with [mcElement]="mcTerminology" [mcDomainType]="'Terminology'"></app-share-with>
        <div>
            <div style="margin-top: 10px">
                <app-user-access-new [parent]="mcTerminology" [parentType]="'Terminology'"></app-user-access-new>
            </div>
            <div style="margin-top: 50px">
                <app-group-access-new [parent]="mcTerminology" [parentType]="'Terminology'"></app-group-access-new>
            </div>
        </div>
    </div>
</div>