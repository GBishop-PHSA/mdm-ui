<div *ngIf="model.createType == 'new'">
    <form #myForm="ngForm" ngNativeValidate class="mdm--form" style="max-width: 100%;">
        <div>Parent Data Class:</div>
        <mdm-model-path [path]="model.parent.breadcrumbs" class="mdm--block"></mdm-model-path>

        <div class="mdm--form-input">
            <mat-form-field appearance="outline">
                <mat-label>Label</mat-label>
                <input matInput [(ngModel)]="model.label" name="label" required>
            </mat-form-field>
        </div>
        <div class="mdm--form-input">
            <mat-form-field appearance="outline">
                <mat-label>Description</mat-label>
                <textarea matInput name="description" [(ngModel)]="model.description"></textarea>
            </mat-form-field>
        </div>

        <div class="mdm--form-input">
            <label>Multiplicity</label>
            <br><small>Use <strong style="font-size: 14px">*</strong> for unbound multiplicity.</small>
            <div flex fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="20px">
                <div fxFlex="33" fxFlex.sm="100" fxFlex.xs="100">
                <mat-form-field appearance="outline">
                    <mat-label>Min</mat-label>
                    <input matInput name="minMultiplicity" [(ngModel)]="model.minMultiplicity">
                </mat-form-field>
                </div>
                <div fxFlex="33" fxFlex.sm="100" fxFlex.xs="100">
                <mat-form-field appearance="outline" class="paddingless">
                    <mat-label>Max</mat-label>
                    <input matInput name="maxMultiplicity" [(ngModel)]="model.maxMultiplicity">
                </mat-form-field>
                </div>
            </div>
            <div style="font-size: 12px;clear: both;margin: 2px 0px" class="error text-danger">
                <span *ngIf="multiplicityError">
                    {{multiplicityError}}
                </span>
            </div>
        </div>

        <div style="padding: 0px 0px 10px 10px;" *ngIf="model.dataType">
            <label>Classifications</label>
            <mdm-element-classifications name="classifiers" (classificationsChanged)="model.classifiers = $event" [editableForm]="{visible :true}"></mdm-element-classifications>
        </div>
    </form>

</div>
<div *ngIf="model.createType == 'copy' && step.active == true" class="row mdm--block">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <span>Please Select a Data Class:</span>
        <mdm-model-selector-tree [defaultCheckedMap]="defaultCheckedMap"
                                [root]="model.copyFromDataModel[0]"
                                [showCheckboxFor]="['DataClass']"
                                [propagateCheckbox]="true"
                                [alwaysShowTree]="true"
                                [hideSelectedElements]="true"
                                [multiple]="true"
                                [processing]="processing"
                                [onCheck]="onCheck"
                                [placeholder]="'Select Data Class(s)'"
                                [accepts]="['DataClass']">
        </mdm-model-selector-tree>
    </div>
</div>


<div *ngIf="model.createType == 'copy'" class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div>
            <div>
                Summary of Selected Data Classes 
                <span class="badge element-count" style="margin: 0px 3px; display: inline;" aria-hidden="false">{{totalItemCount}}</span>
            </div>
            <div>
                <table mat-table matSort [dataSource]="dataSource" class="mdm--table table table-borderless table-striped table-responsive">
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef style="cursor: pointer; max-width: 15%; width: 15%;" columnName="label"
                            sortable="true" filterable="true">
                            Name
                        </th>
                        <td mat-cell *matCellDef="let record" style="max-width: 15%; width: 15%; text-align: left; word-wrap: break-word;">
                            <div>
                                <mdm-element-link [element]="record" [newWindow]="true" [parentDataModel]="{id:record.dataModel}"></mdm-element-link>
                            </div>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="description">
                        <th mat-header-cell *matHeaderCellDef style="cursor: pointer; max-width: 20%; width: 20%;" columnName="description" sortable="true" filterable="true">
                            Description
                        </th>
                        <td mat-cell *matCellDef="let record" style="max-width: 20%; width: 20%; text-align: left; word-wrap: break-word;">
                            <div *ngIf="record.description && record.description.length>0" style="margin-bottom: 10px;">
                                <mdm-more-description [description]="record.description"></mdm-more-description>
                            </div>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="status">

                        <th mat-header-cell *matHeaderCellDef style="cursor: pointer; max-width: 15%; width: 15%;">
                            Status
                        </th>
                        <td mat-cell *matCellDef="let record" style="max-width: 15%; width: 15%; text-align: left; word-wrap: break-word;">
                            <span *ngIf="finalResult && finalResult[record.id] && finalResult[record.id].hasError">
                                <div><i class="fas fa-times"></i></div>
                                <div class="errorMessage">{{finalResult[record.id].result}}</div>
                            </span>
                            <span *ngIf="finalResult && finalResult[record.id] && !finalResult[record.id].hasError">
                                <div><i class="fas fa-check copyElementSuccess"></i>&nbsp;Success</div>
                            </span>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
            </div>
            <div class="mdm--mat-pagination">
                <mdm-paginator [pageSizeOptions]="[5, 10, 20,50]" [pageSize]="20" showFirstLastButtons></mdm-paginator>
            </div>
        </div>
        <div style="margin-top: 50px; width: 100%;">
            <div *ngIf="processing">
                <mat-progress-bar mode="indeterminate"></mat-progress-bar>
            </div>
            <div *ngIf="!processing && isProcessComplete">
                <div class="alert alert-success" *ngIf="failCount === 0">
                    <strong>Success!</strong> All copied successfully!
                </div>
                <div class="alert alert-danger" *ngIf="failCount > 0">
                    <strong>Error!</strong> {{failCount}} Error(s) in copy process!
                </div>
            </div>
        </div>


    </div>
    <div class="mdm--mat-pagination">
        <mat-paginator [pageSizeOptions]="[5, 10, 20,50]" [pageSize]="20" showFirstLastButtons></mat-paginator>
    </div>
</div>
<div style="margin-top: 50px; width: 100%;">
    <div *ngIf="processing">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
    <div *ngIf="!processing && isProcessComplete">
        <div class="alert alert-success" *ngIf="failCount === 0">
            <strong>Success!</strong> All copied successfully!
        </div>
        <div class="alert alert-danger" *ngIf="failCount > 0">
            <strong>Error!</strong> {{failCount}} Error(s) in copy process!
        </div>
    </div>
</div>